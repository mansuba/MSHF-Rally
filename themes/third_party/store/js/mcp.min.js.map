{"version":3,"file":"mcp.min.js","sources":["../../../../sources/js/mcp/dashboard.js","../../../../sources/js/mcp/global.js"],"names":["global","$","initChart","box","data","find","remove","html","prev_days","periods","current","sum_str","trend_percent","removeClass","addClass","trend_direction","days","chartdata","day2","prev","push","moment","toDate","getTime","day","data1","points","fillColor","size","color","plot","chartOptions","holder","length","metricBoxes","each","index","elem","loadingElem","Spinner","spin","ajax","url","Store","MCP_AJAX_URL","type","dataType","sc","date_start","date_end","metric","success","rdata","error","xaxis","show","yaxis","series","lines","lineWidth","fill","zero","shadowSize","colors","grid","borderColor","hoverable","backgroundColor","minBorderMargin","borderWidth","margin","top","right","bottom","left","window","jQuery","setGetParameter","paramName","paramValue","location","href","indexOf","prefix","substring","suffix","datepicker","dateFormat","timepicker","timeFormat","bind","e","target","nodeName","val","docCookies","setItem","Subs","COOKIE_PREFIX","reload","daterangepicker","opens","ranges","Last 7 Days","subtract","Last 30 Days","This Month","startOf","endOf","Last Month","Last 3 Months","start","end","this","element","format","datestr"],"mappings":"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","sourcesContent":[";(function(global, $){\n    //es5 strict mode\n    \"use strict\";\n\n    var holder = $('#store');\n    if (holder.length === 0) return;\n\n    var metricBoxes = holder.find('.metric');\n\n    // ----------------------------------------------------------------------\n    // Activate Loading\n    // ----------------------------------------------------------------------\n    metricBoxes.each(function(index, elem){\n        var loadingElem = $(elem).find('.loading-chart');\n        if (loadingElem.length == 0) return;\n\n        new Spinner().spin(loadingElem[0]);\n    });\n\n    // ----------------------------------------------------------------------\n    // Activate Charts\n    // ----------------------------------------------------------------------\n    metricBoxes.each(function(index, elem){\n        var box = $(elem);\n\n        $.ajax({\n            url: Store.MCP_AJAX_URL, type: 'GET', dataType: 'json',\n            data: {\n                sc: 'metric',\n                date_start: box.data('date_start'),\n                date_end: box.data('date_end'),\n                metric: box.data('metric'),\n            },\n            success: function(rdata){\n                initChart(box, rdata);\n            },\n            error: function() {\n                box.find('.loading-chart').remove();\n            }\n        });\n    });\n\n    // ----------------------------------------------------------------------\n    // Create Chart\n    // ----------------------------------------------------------------------\n    function initChart(box, data) {\n        box.find('.loading-chart').remove();\n\n        if (!data) return;\n\n        box.find('.prev_days').html(data.prev_days);\n        box.find('.primary').html(data.periods.current.sum_str);\n\n        box.find('.trend .percentage').html(data.trend_percent);\n        box.find('.trend').removeClass('trend-up trend-down trend-neutral').addClass('trend-'+data.trend_direction);\n\n        if (!data.periods.current.days) return;\n\n        var chartdata = [];\n\n        for (var day2 in data.periods.prev.days) {\n            chartdata.push(  [moment(day2).toDate().getTime(), data.periods.prev.days[day2]]  );\n        }\n\n        for (var day in data.periods.current.days) {\n            chartdata.push(  [moment(day).toDate().getTime(), data.periods.current.days[day]]  );\n        }\n\n        var data1 = [\n            {data: chartdata, points: { fillColor: \"#F9FCFE\", size: 5 }, color: '#4572A7' },\n        ];\n\n        $.plot(box.find('.chart'), data1, chartOptions);\n    }\n\n    // ----------------------------------------------------------------------\n    // Default Chart Options\n    // ----------------------------------------------------------------------\n    var chartOptions = {\n        xaxis: {show: false},\n        yaxis: {show: false},\n        series: {\n            lines: {\n                show: true,\n                lineWidth: 6,\n                fill: !0,\n                zero: !1,\n                fillColor: \"rgba(26,140,201,0.2)\",\n            },\n            shadowSize: 0,\n            points: {\n                show: false\n            },\n        },\n        colors: [\n            \"rgba(26,140,201,1)\"\n        ],\n        grid: {\n            color: \"#646464\",\n            borderColor: \"transparent\",\n            hoverable: false,\n            backgroundColor: \"transparent\",\n            minBorderMargin: 0,\n            borderWidth: 0,\n            margin: {\n                top: 20,\n                right: 0,\n                bottom: 0,\n                left: 0\n            }\n        },\n    };\n\n}(window, jQuery));\n\n// ----------------------------------------------------------------------",";(function(global, $){\n    //es5 strict mode\n    \"use strict\";\n\n    var holder = $('#store');\n\n    // ----------------------------------------------------------------------\n\n    holder.find('.datepicker').each(function(index, elem){\n        $(elem).datepicker({\n            dateFormat: 'yy-mm-dd'\n        });\n    });\n\n    // ----------------------------------------------------------------------\n\n    holder.find('.timepicker').each(function(index, elem){\n        $(elem).timepicker({\n            timeFormat: 'H:i'\n        });\n    });\n\n    // ----------------------------------------------------------------------\n\n    holder.find('.data-toggle').bind('click', function(e){\n        if (e.target.nodeName != 'INPUT') return;\n        var val = $(e.target).val();\n        docCookies.setItem(Subs.COOKIE_PREFIX+'subs_data', val, 5184000, '/');\n        window.location.reload();\n    });\n\n    // ----------------------------------------------------------------------\n\n    holder.find('.dateranger').daterangepicker(\n        {\n            opens:'left',\n            ranges: {\n                'Last 7 Days': [moment().subtract('days', 6), moment()],\n                'Last 30 Days': [moment().subtract('days', 29), moment()],\n                'This Month': [moment().startOf('month'), moment().endOf('month')],\n                'Last Month': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')],\n                'Last 3 Months': [moment().subtract('month', 3).endOf('month'), moment()]\n            },\n        },\n        function(start, end) {\n            this.element.find('span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));\n\n            var datestr = start.format('YYYY-MM-DD')+','+end.format('YYYY-MM-DD');\n            setGetParameter('daterange', datestr);\n        }\n    );\n\n    // ----------------------------------------------------------------------\n\n    function setGetParameter(paramName, paramValue)\n    {\n        var url = window.location.href;\n        if (url.indexOf(paramName + \"=\") >= 0)\n        {\n            var prefix = url.substring(0, url.indexOf(paramName));\n            var suffix = url.substring(url.indexOf(paramName));\n            suffix = suffix.substring(suffix.indexOf(\"=\") + 1);\n            suffix = (suffix.indexOf(\"&\") >= 0) ? suffix.substring(suffix.indexOf(\"&\")) : \"\";\n            url = prefix + paramName + \"=\" + paramValue + suffix;\n        }\n        else\n        {\n        if (url.indexOf(\"?\") < 0)\n            url += \"?\" + paramName + \"=\" + paramValue;\n        else\n            url += \"&\" + paramName + \"=\" + paramValue;\n        }\n        window.location.href = url;\n    }\n\n    // ----------------------------------------------------------------------\n\n}(window, jQuery));\n\n// ----------------------------------------------------------------------"]}